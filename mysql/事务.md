# Mysql 事务



## 特性

- 原子性。指事务是一个最小单元，不可再分隔，成为一个整体。
- 一致性。指事务中的方法要么同时成功，要么同时失败。
- 隔离性。是指当多个事务操作数据库中同一个记录或多个记录时，对事务进行隔离开来有序执行，避免同时对同一数据做操作。需要使用**锁**来解决这个问题。
- 持久性。事务成功，数据永久存储。



## 隔离级别

设置隔离级别

```text
// 全局;
set global transaction isolation level read uncommitted;
// 当前会话;
set session transaction isolation level read uncommitted;
```

### 读未提交 （Read uncommitted ）

​	此隔离级别会出现**脏读**。两个并行的事务A, B操作同一记录，事务A读取到B未提交的事务。

### 读已提交（Read committed）

​	此隔离级别会出现**不可重复读**。两个并行的事务A, B操作同一记录。事务B对数据修改未提交，事务A读取到未提交的数据(原始数据)，事务B提交事务，事务A再次读取，事务A读取到B提交的数据(事务B修改的数), 导致两次读取数据信息不一致。

### 可重复读（Repeatable read）

​	**默认采用的隔离级别**。此隔离级别会出现**幻读**。两个并行的事务A, B执行插入同一数据（如主键Id为1），B事务插入数据但未提交，A事务查询不到Id为1的数据，B事务提交, A事务执行插入主键Id为1数据时又出现异常(主键冲突)。解决幻读问题，可设置可串行化隔离级别解决或用加锁方式。

### 可串行化（Serializable）

​	另外还有一种事务级别就是序列化方式SERIALIZABLE，序列化事务级别既不允许脏读，也不允许不可重复读，并且还不允许幻读。事务隔离级别越严格，越消耗计算机性能，效率也越低，通常情况下，设置为不可重复读就可以解决大多数的问题了。

